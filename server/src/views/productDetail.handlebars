<a href="/products" style="display: inline-block; margin-bottom: 20px; color: #667eea; text-decoration: none;">‚Üê Volver a productos</a>

<div style="max-width: 800px; margin: 0 auto;">
    <h1 style="margin-bottom: 30px;">{{product.title}}</h1>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
        <!-- Imagen del producto (placeholder) -->
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); height: 400px; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 4rem;">
            üñºÔ∏è
        </div>

        <!-- Detalles del producto -->
        <div>
            <h2 style="color: #333; margin-bottom: 20px; font-size: 2rem;">${{product.price}}</h2>

            <div style="margin-bottom: 20px;">
                <span style="background: {{#if product.status}}#28a745{{else}}#dc3545{{/if}}; color: white; padding: 8px 16px; border-radius: 20px; font-size: 0.9rem;">
                    {{#if product.status}}‚úì Disponible{{else}}‚úó Agotado{{/if}}
                </span>
            </div>

            <p style="color: #666; line-height: 1.6; margin-bottom: 20px; font-size: 1.1rem;">
                {{product.description}}
            </p>

            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 25px;">
                <p style="margin-bottom: 10px;"><strong>Categor√≠a:</strong> {{product.category}}</p>
                <p style="margin-bottom: 10px;"><strong>Stock disponible:</strong> {{product.stock}} unidades</p>
                <p><strong>Estado:</strong> {{#if product.status}}Activo{{else}}Inactivo{{/if}}</p>
            </div>

            {{#if product.status}}
            <div style="display: flex; gap: 10px;">
                <input type="number" id="quantity" value="1" min="1" max="{{product.stock}}" 
                       style="width: 80px; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 1rem;">
                <button onclick="addToCart('{{product._id}}')" class="btn" style="flex: 1; font-size: 1.1rem;">
                    üõí Agregar al carrito
                </button>
            </div>
            {{else}}
            <button class="btn" disabled style="opacity: 0.5; cursor: not-allowed; width: 100%;">
                Producto no disponible
            </button>
            {{/if}}
        </div>
    </div>
</div>

<script>
    const cartId = localStorage.getItem('cartId') || createCart();

    async function createCart() {
        const response = await fetch('/api/carts', { method: 'POST' });
        const data = await response.json();
        const newCartId = data.data._id;
        localStorage.setItem('cartId', newCartId);
        return newCartId;
    }

    async function addToCart(productId) {
        const quantity = document.getElementById('quantity').value;
        
        try {
            // Agregar producto al carrito (la cantidad se suma en el backend)
            for (let i = 0; i < quantity; i++) {
                await fetch(`/api/carts/${cartId}/product/${productId}`, {
                    method: 'POST'
                });
            }
            
            alert(`‚úÖ ${quantity} producto(s) agregado(s) al carrito`);
        } catch (error) {
            alert('‚ùå Error al agregar al carrito');
        }
    }
</script>